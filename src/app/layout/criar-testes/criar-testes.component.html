<div class="vh-100 d-flex position-fixed w-100" style="background-color: #FAFAFA; overflow-y : auto;">
    <div class="container pt-3 h-100">

        <ngb-tabset (tabChange)="reset($event)" [justify]="'fill'">


            <!------------------------------------Gerador Testes---------------------------------------------------->
            <ngb-tab title="Gerador de Testes">
                <ng-template ngbTabContent>
                    <br>

                    <form #testForm="ngForm" class="container pt-3" (submit)="submitTest();">
                        <div class=" container h-100 w-100"
                            style="padding: 16px; box-shadow: 0 5px 5px -3px rgba(0,0,0,.2), 0 8px 10px 1px rgba(0,0,0,.14), 0 3px 14px 2px rgba(0,0,0,.12);">
                            <h1 class="margin-bottom">Gerador de Testes</h1>


                            <div class="form-group">
                                <div class="input-group row justify-content-around">
                                    <div class="input-group-text" style="margin-left: 16px;">
                                        <label class="sr-only" for="inlineFormInputGroup"></label>Nome
                                    </div>
                                    <input required [(ngModel)]="testName" name="testNameChosen"
                                        #testNameChosen="ngModel" type="text" class="form-control"
                                        id="inlineFormInputGroup" placeholder="Nome do Teste">
                                </div>
                                <div class="row">
                                    <div class="col-4">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text" id="btnGroupAddon" for="duracaoTestes">
                                                    Duração</div>
                                            </div>
                                            <input style="width: 35%;" required [(ngModel)]="timer" step="5"
                                                name="timerChosen" #timerChosen="ngModel" min="0" max="340"
                                                id="duracaoTestes" type="Number" placeholder="Minutos">
                                        </div>
                                    </div>
                                    <div class="col-5">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text" id="btnGroupAddon" for="categoriaTestes">
                                                    Categoria</div>
                                            </div>
                                            <select style="height: 38px; width: 45%; color: #495057;" required
                                                [(ngModel)]="category" name="categoryChosen" #categoryChosen="ngModel"
                                                (change)="getNumberOfQuestionsByCategory(); numberOfQuestions=0" id="">
                                                <ng-container *ngFor="let category of categories$ | async">
                                                    <option value="" selected disabled hidden>Escolha uma Categoria
                                                    </option>
                                                    <option value={{category.category.category}}>
                                                        {{category.category.category}}
                                                    </option>
                                                </ng-container>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-3" *ngIf="maximum">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text" id="btnGroupAddon" for="perguntasTestes">
                                                    Nº Perguntas:&nbsp; </div>
                                                <input required [(ngModel)]="numberOfQuestions"
                                                    name="numberOfQuestionsChosen" type="Number" min="0"
                                                    max="{{maximum}}">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div [hidden]="!successMessage" class="alert alert-success text-center mt-3">
                                    Teste Gerado!
                                </div>


                                <button [disabled]="!testForm.form.valid || numberOfQuestions == 0" type="button"
                                    class="btn btn-primary orangeButton" value="+" (click)="addInfo()">Adicionar
                                    Pergunta(s) ao Teste</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

                                <br>

                                <div
                                    *ngFor="let question of allRandomQuestions | paginate: { itemsPerPage: 1, currentPage: p }, let j=index">
                                    <br>

                                    <h2
                                        *ngIf="j!=0 && allRandomQuestions[j-1].category.category!=allRandomQuestions[j].category.category || j==0">
                                        {{question.category.category}}
                                    </h2>
                                    <br>
                                    <div class="container border border-dark rounded">
                                        <br>
                                        <div class="row">
                                            <div class="col-sm-1 .offset col-sm-11"></div>
                                            <input class="btn text-white rounded" type="button" value="Trocar"
                                                style="background-color: orangered;" (click)="changeQuestion(p-1)">

                                        </div>

                                        <h4>{{question.question}}</h4><br>
                                        <div *ngFor="let option of question.options, let i=index">
                                            <div class="ml-2" *ngIf="question.solution.indexOf(i)!=-1">
                                                {{option}}
                                                <div class="pretty p-icon p-smooth">
                                                    <input type="checkbox" [checked]="true" disabled="disabled">
                                                    <div class="state p-success">
                                                        <i class="icon fa fa-check"></i>
                                                        <label></label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="ml-2" *ngIf="question.solution.indexOf(i)==-1">
                                                {{option}}
                                                <div class="pretty p-icon p-smooth">
                                                    <input type="checkbox" disabled="disabled">
                                                    <div class="state p-success">
                                                        <i class="icon fa fa-check"></i>
                                                        <label></label>
                                                    </div>
                                                </div>
                                            </div>
                                            <hr>
                                        </div>
                                        <div class="text-center">
                                            <pagination-controls previousLabel="Anterior" nextLabel="Próximo"
                                                class="my-pagination" (pageChange)="p = $event;"></pagination-controls>
                                        </div>
                                        <div *ngIf='testError!=""' class="alert alert-danger text-center mt-3">
                                            Já existe um teste com esse nome!
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="text-center">
                            <input [disabled]="!testNameChosen.valid || !timerChosen.valid || allRandomQuestions==0"
                                type="submit" id="margin-top" class="btn btn-primary orangeButton" value="Gerar Teste">
                        </div>
                    </form>
                    <div class="spacer" style="height: 100px"></div>
                </ng-template>

            </ngb-tab>


            <!------------------------------------Gerador Perguntas--------------------------------------------------->
            <ngb-tab title="Gerador de Perguntas">
                <ng-template ngbTabContent>
                    <br>
                    <form #questionForm="ngForm" class="container pt-3" (submit)="addQuestion();">

                        <div class=" container h-100 w-100"
                            style="padding: 16px; box-shadow: 0 5px 5px -3px rgba(0,0,0,.2), 0 8px 10px 1px rgba(0,0,0,.14), 0 3px 14px 2px rgba(0,0,0,.12);">
                            <h1>Gerador de Perguntas</h1>


                            <div class="form-group">
                                <div>
                                    <div>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text" id="btnGroupAddon" for="categoriaTestes">
                                                    Categoria</div>
                                            </div>
                                            <select required [(ngModel)]="category" name="categoryChosen"
                                                aria-placeholder="opção" style="width: 91%; color: #495057; ">
                                                <ng-container *ngFor="let myCategory of categories">
                                                    <option value="" selected disabled hidden>Escolha uma Categoria
                                                    </option>
                                                    <option [value]="myCategory.category.category">
                                                        {{myCategory.category.category}}
                                                    </option>
                                                </ng-container>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text" id="btnGroupAddon">Pergunta </div>
                                            </div>
                                            <input (click)="errorAlertQuestionsReset()" required
                                                [(ngModel)]="questionString" name="questionWritten" type="text"
                                                class="form-control" style="width: 65%" aria-label="Input group example"
                                                aria-describedby="btnGroupAddon" placeholder="Introduza Pergunta">
                                        </div>
                                        <br>

                                        <div class="row">
                                            <div class="col-md-11">

                                                <textarea required class="rounded" style="width: 100%"
                                                    placeholder="Introduza Opção" [(ngModel)]="options[0]"
                                                    name="optionWritten0" (change)="checkValidityQuestion()"></textarea>

                                            </div>
                                            <div class="col-md-1" style="padding: 14px 0 0 25px;">

                                                <div class="pretty p-icon p-smooth ">
                                                    <input [(ngModel)]="firstCheck" name="checkFirstCheck"
                                                        (change)="onChange(0, $event.target.checked)" type="checkbox">
                                                    <div class="state p-success">
                                                        <i class="icon fa fa-check"></i>
                                                        <label></label>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                        <div *ngFor="let i of numberOfTimes, let j=index">

                                            <div class="row">
                                                <div class="col-md-11">
                                                    <textarea class="rounded" style="width: 100%"
                                                        placeholder="Introduza Opção" [(ngModel)]="options[j+1]"
                                                        name="optionWritten{{j+1}}"
                                                        (change)="checkValidityQuestion()"></textarea>
                                                </div>

                                                <div class="col-md-1" style="padding: 14px 0 0 25px;">

                                                    <div class="pretty p-icon p-smooth">
                                                        <input (change)="onChange(j+1, $event.target.checked)"
                                                            style="padding-bottom: 5px" type="checkbox">
                                                        <div class="state p-success">
                                                            <i class="icon fa fa-check"></i>
                                                            <label></label>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <p></p>
                                        <input type="button" [disabled]="!questionFormValidity" name=""
                                            class="btn btn-primary orangeButton" (click)="addOption()"
                                            value="Adicionar Opção">
                                        <br>

                                    </div>
                                </div>
                            </div>
                            <div *ngIf='questionError!=""' class="alert alert-danger text-center">
                                Essa pergunta já existe!
                            </div>
                            <div [hidden]="!successMessage" class="alert alert-success text-center">
                                Pergunta criada!
                            </div>
                        </div>

                        <div class="text-center">
                            <input type="submit"
                                [disabled]="!questionForm.form.valid || solution.length==0 || !questionFormValidity"
                                class="btn btn-primary orangeButton" value="Gerar Pergunta">
                        </div>
                    </form>
                    <div class="spacer" style="height: 100px"></div>
                </ng-template>
            </ngb-tab>

            <!------------------------------------Gerador Categorias---------------------------------------------------->
            <ngb-tab title="Gerador de Categorias">
                <ng-template ngbTabContent>
                    <br>
                    <form #categoryForm="ngForm" class="container pt-3" (ngSubmit)="submitCategory();">
                        <div class=" container h-100 w-100"
                            style="padding: 16px; box-shadow: 0 5px 5px -3px rgba(0,0,0,.2), 0 8px 10px 1px rgba(0,0,0,.14), 0 3px 14px 2px rgba(0,0,0,.12);">
                            <h1>Gerador de Categorias</h1>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <div class="input-group-text" id="btnGroupAddon">Categoria</div>
                                </div>
                                <input (click)="errorAlertCategoriesReset()" name="categoryChosen"
                                    #categoryChosen="ngModel" [(ngModel)]="categoryString" type="text"
                                    class="form-control" aria-label="Input group example"
                                    aria-describedby="btnGroupAddon" required placeholder="Introduza Categoria">
                            </div>
                            <!--<div [hidden]="categoryChosen.valid || categoryChosen.pristine || categoryChosen.untouched" class="alert alert-danger">
                      Name is required
                    </div>-->
                            <div [hidden]='categoryError==""' class="alert alert-danger text-center mt-3">
                                Essa categoria já existe!
                            </div>
                            <div class="text-center mt-3">
                                <span>
                                    <div [hidden]="!successMessage" class="alert alert-success">
                                        Categoria criada!
                                    </div>
                                </span>
                            </div>
                            <br><br>
                        </div>

                        <div class="text-center">
                            <input class="mt-3" type="submit" [disabled]="!categoryForm.form.valid"
                                class="btn btn-primary orangeButton" value="Gerar Categoria">
                        </div>
                    </form>
                </ng-template>
            </ngb-tab>
        </ngb-tabset>

    </div>
</div>